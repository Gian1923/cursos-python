
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>56. Pivot tables y joins &#8212; Inteligencia Artificial Moderna</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="57. Ejercicios Pandas II" href="clase-2-ejercicios.html" />
    <link rel="prev" title="55. Ejercicios Pandas I" href="../1_Indexing/ejercicio/ejercicio.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logohumai.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Inteligencia Artificial Moderna</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Inteligencia Artificial Moderna
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduccion a la Programación con Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/README.html">
   1. Introducción a Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/1_TiposDatos/tipos-datos.html">
   2. Introducción a la programación con Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/1_TiposDatos/ejercicio/ejercicios.html">
   7. Ejercicios I
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/2_Listas_Y_Funciones/listas-funciones.html">
   8. Listas, Funciones, Errores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/2_Listas_Y_Funciones/ejercicio/ejercicio.html">
   16. Ejercicios II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/2_Listas_Y_Funciones/ejercicio/adicionales.html">
   17. Ejercicios Adicionales II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/3_Modulos_Funciones/modulos-funciones.html">
   18. Módulos y Algorítmos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/3_Modulos_Funciones/ejercicio/ejercicio.html">
   21. Ejercicios III
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/4_Intro_Poo/intro-poo.html">
   22. Programación orientada a objetos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/4_Intro_Poo/ejercicio/ejercicio.html">
   23. Ejercicios POO IV
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/5_Poo_Experimento/poo-experimento.html">
   24. Aplicación de POO: Experimento de Tiempo de Reacción
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Introduccion/6_Poo_Proyecto/poo-proyecto.html">
   25. Aplicación de POO: PACMAN
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Automatización
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Automatizacion/README.html">
   26. Automatización y Minería Web
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Automatizacion/Automatizaci%C3%B3n_I/automatizacion_pygui_bash_os.html">
   27. Automatización
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Automatizacion/Automatizaci%C3%B3n_2/clase_automatizacion_2_gsheets_cron_mails.html">
   29. Automatización II: outputs, envío de mail, volcado a GSheets, scheduling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Automatizacion/Automatizaci%C3%B3n_2/clase_automatizacion_2_ejercicios.html">
   30. Ejercicios Automatización II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Automatizacion/Expresiones_Regulares/expresiones_regulares.html">
   31. Expresiones Regulares
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Automatizacion/Otros/gsheets_pytrends.html">
   32. Práctica: GSheet y PyTrends
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Automatizacion/Otros/organizando_pdfs.html">
   33. Ejercicio: Organizando PDFs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Automatizacion/Otros/edicion_imagenes.html">
   34. Edición de Imágenes con Python
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Minería Web
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Scraping/README.html">
   35. Minería Web con Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Scraping/1_HTTP_Inicial/web_scraping_http_inicial.html">
   36. Web Scraping: Extrayendo datos de Internet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Scraping/1_HTTP_Inicial/ejercicio/spinetta.html">
   37. Descargar letras de canciones
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Scraping/2_HTTP_Avanzado/scraping_http_avanzado.html">
   38. Encontrando APIs ocultas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Scraping/2_HTTP_Avanzado/scraping_avanzado_2.html">
   42. Práctica: Scraping Avanzado 2:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Scraping/2_HTTP_Avanzado/ejercicio/apis-ocultas.html">
   44. Argenprop
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Scraping/2_HTTP_Avanzado/scraping_extra_tips.html">
   46. Tips para scrapear mejor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Scraping/3_Selenium_y_xpath/scraping_por_automatizacion.html">
   47. Scraping por Automatización con Selenium
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  APIs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../APIs/README.html">
   48. APIs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../APIs/1_APIs_Geograficas/clase-1.html">
   49. APIs geográficas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../APIs/1_APIs_Geograficas/clase-1-ejercicios.html">
   50. APIs Geográficas: Ejercicios
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../APIs/2_APIs_Series_Tiempo/clase-2.html">
   51. APIs de Series de Tiempo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../APIs/2_APIs_Series_Tiempo/ejercicios/ejercicios.html">
   52. APIs Series de Tiempo: Ejercicios
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Análisis de Datos
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   53. Analisis de datos con Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1_Indexing/Indexing.html">
   54. Indexación y Agregación
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1_Indexing/ejercicio/ejercicio.html">
   55. Ejercicios Pandas I
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   56. Pivot tables y joins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="clase-2-ejercicios.html">
   57. Ejercicios Pandas II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3_Agrupacion_y_Agregacion/agrupacion_agregacion.html">
   58. Agrupación
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3_Agrupacion_y_Agregacion/ejercicio/ejercicio.html">
   59. Ejercicios Pandas III
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4_Data_Wrangling_Avanzado/data_wrangling_avanzado.html">
   60. Data Wrangling Avanzado
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4_Data_Wrangling_Avanzado/ejercicio/ejercicio.html">
   61. Ejercicio Pandas IV: Informe macroeconómico de Argentina
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5_Visualizacion/Visualizacion_Pandas.html">
   62. Visualización con Pandas y Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5_Visualizacion/Visualizacion_Plotly.html">
   63. Visualización con Plotly
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5_Visualizacion/Ejercitacion/Ejercitacion_Extra.html">
   64. Ejercicios Visualización
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Aprendizaje Automático
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/README.html">
   65. Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/1_Introduccion/rls.html">
   66. Regresión Lineal Simple
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/2_RegresionLinealMultiple/RegresionLinealMultiple.html">
   68. Regresión Lineal Múltiple
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/3_Regularizacion/Regularizacion.html">
   69. Regularización - Optimización - Feature Engineering - Pipelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/5_KNNyArbolesDeDecision/KNN_Arboles.html">
   70. Modelos no paramétricos: K-Nearest Neighbours y Árboles de decisión
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/6_Ensamble/Bagging%26Boosting.html">
   71. Ensambles: Bagging &amp; Boosting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/8_ShapyAnomalias/anomaly-detection-shap-values.html">
   72. Detección de anomalías y explicabilidad de modelos con valores SHAP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/9_SeriesDeTiempo/1.ARIMA.html">
   73. Series de tiempo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/9_SeriesDeTiempo/2.Prophet.html">
   74. Prophet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/10_Recomendacion/sistemas_recomendacion.html">
   75. Sistemas de Recomendación
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Colaboración
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../General/0_Colaboracion/Guia%20para%20armar%20contenido.html">
   76. Generando contenido
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/AnalisisDeDatos/2_Pivot_Table_y_Joins/clase-2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://institutohumai.github.io/cursos-python/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://institutohumai.github.io/cursos-python//issues/new?title=Issue%20on%20page%20%2FAnalisisDeDatos/2_Pivot_Table_y_Joins/clase-2.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tabla-de-contenidos">
   56.1. Tabla de Contenidos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parametros-y-extraccion-de-datos">
   56.2. Parámetros y extracción de datos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pivot-table">
   56.3. Pivot table
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#contar-casos-a-partir-de-un-registro">
     56.3.1. Contar casos a partir de un registro
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-un-panel-a-partir-de-un-registro">
     56.3.2. Crear un panel a partir de un registro
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concat">
   56.4. Concat
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#str">
   56.5. .str
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#str-replace">
     56.5.1. .str.replace()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#str-split">
     56.5.2. .str.split()
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#map">
   56.6. .map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge">
   56.7. Merge
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Pivot tables y joins</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tabla-de-contenidos">
   56.1. Tabla de Contenidos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parametros-y-extraccion-de-datos">
   56.2. Parámetros y extracción de datos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pivot-table">
   56.3. Pivot table
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#contar-casos-a-partir-de-un-registro">
     56.3.1. Contar casos a partir de un registro
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crear-un-panel-a-partir-de-un-registro">
     56.3.2. Crear un panel a partir de un registro
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concat">
   56.4. Concat
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#str">
   56.5. .str
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#str-replace">
     56.5.1. .str.replace()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#str-split">
     56.5.2. .str.split()
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#map">
   56.6. .map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge">
   56.7. Merge
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <p><a href="https://colab.research.google.com/github/institutohumai/cursos-python/blob/master/AnalisisDeDatos/2_Pivot_Table_y_Joins/clase-2.ipynb"> <img src='https://colab.research.google.com/assets/colab-badge.svg' /> </a></p>
<div align="center"> Recordá abrir en una nueva pestaña </div>
<div class="tex2jax_ignore mathjax_ignore section" id="pivot-tables-y-joins">
<h1><span class="section-number">56. </span>Pivot tables y joins<a class="headerlink" href="#pivot-tables-y-joins" title="Permalink to this headline">¶</a></h1>
<div class="section" id="tabla-de-contenidos">
<h2><span class="section-number">56.1. </span>Tabla de Contenidos<a class="headerlink" href="#tabla-de-contenidos" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>I. Clase 2: Pivot tables y joins
    I. Parámetros y extracción de datos
    II. Pivot table
        I. Contar casos a partir de un registro
        II. Crear un panel a partir de un registro
    III. Concat
    IV. .str
        I. .str.replace()
        II. .str.split()
    V. .map
    VI. Merge
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parametros-y-extraccion-de-datos">
<h2><span class="section-number">56.2. </span>Parámetros y extracción de datos<a class="headerlink" href="#parametros-y-extraccion-de-datos" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># input</span>
<span class="n">CASOS_URL</span> <span class="o">=</span> <span class="s2">&quot;https://sisa.msal.gov.ar/datos/descargas/covid-19/files/Covid19Casos.csv&quot;</span>
<span class="n">DETERMINACIONES_URL</span> <span class="o">=</span> <span class="s2">&quot;https://sisa.msal.gov.ar/datos/descargas/covid-19/files/Covid19Determinaciones.csv&quot;</span>

<span class="n">CASOS_URL_S3</span> <span class="o">=</span> <span class="s2">&quot;https://datasets-humai.s3.amazonaws.com/datasets/covid_casos.zip&quot;</span>
<span class="n">DETERMINACIONES_URL_S3</span> <span class="o">=</span> <span class="s2">&quot;https://datasets-humai.s3.amazonaws.com/datasets/covid_determinaciones.csv&quot;</span>

<span class="n">CASOS_PATH</span> <span class="o">=</span> <span class="s2">&quot;data/covid_casos.csv&quot;</span>
<span class="n">DETERMINACIONES_PATH</span> <span class="o">=</span> <span class="s2">&quot;data/covid_determinaciones.csv&quot;</span>

<span class="c1"># output</span>
<span class="n">PANEL_CASOS_PATH</span> <span class="o">=</span> <span class="s2">&quot;data/covid19-casos-panel.csv&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Si los sacamos de internet, podemos usar directamente la URL de cualquier CSV. Siempre es buena práctica guardar una copia por si en algún momento una URL deja de estar disponible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">converters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;residencia_provincia_id&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="s2">&quot;departamento_provincia_id&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="s2">&quot;codigo_indec_provincia&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="s2">&quot;codigo_indec_departamento&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># lee los datos de internet (original)</span>
<span class="n">casos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">CASOS_URL</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">)</span>
<span class="n">determinaciones</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DETERMINACIONES_URL</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">)</span>

<span class="c1"># lee los datos de internet (S3 de humai)</span>
<span class="c1">#casos = pd.read_csv(CASOS_URL_S3, converters=converters)</span>
<span class="c1">#determinaciones = pd.read_csv(DETERMINACIONES_URL_S3, converters=converters)</span>

<span class="c1"># guarda los datos localmente</span>
<span class="c1">#casos.to_csv(CASOS_PATH, encoding=&quot;utf8&quot;, index=False)</span>
<span class="c1">#determinaciones.to_csv(DETERMINACIONES_PATH, encoding=&quot;utf8&quot;, index=False)</span>

<span class="c1"># lee la copia local</span>
<span class="c1">#casos = pd.read_csv(CASOS_PATH, converters=converters)</span>
<span class="c1">#determinaciones = pd.read_csv(DETERMINACIONES_PATH, converters=converters)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pivot-table">
<h2><span class="section-number">56.3. </span>Pivot table<a class="headerlink" href="#pivot-table" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html</a></p>
<p>La función de <code class="docutils literal notranslate"><span class="pre">DataFrame.pivot_table</span></code> permite crear una tabla dinámica (de la misma forma que se podría hacer en una planilla de cálculo como Excel) fácilmente, eligiendo qué columnas se quieren mostrar en:</p>
<ul class="simple">
<li><p><strong>índice (index)</strong>: lo que se usa para abrir los datos en filas.</p></li>
<li><p><strong>columnas (columns)</strong>: lo que se usa para abrir los datos en columnas.</p></li>
<li><p><strong>valores (values)</strong>: las variables que se quieren abrir en filas y columnas.</p></li>
</ul>
<p>Y se puede elegir una o más funciones de agregación para aplicar a los valores cuando son agregados.</p>
<div class="section" id="contar-casos-a-partir-de-un-registro">
<h3><span class="section-number">56.3.1. </span>Contar casos a partir de un registro<a class="headerlink" href="#contar-casos-a-partir-de-un-registro" title="Permalink to this headline">¶</a></h3>
<p><strong>Casos</strong></p>
<p>En el dataset de <strong>casos</strong> nos enfrentamos a un <strong>registro</strong>: el dataset es una lista de casos, donde cada fila es un “caso”. No tenemos columnas con variables agregadas, tenemos la materia prima sobre la cual se construyen las estadísticas o las agregaciones de cualquier tipo.</p>
<p>Las tablas dinámicas son una buena forma de agregar! En este caso la primera agregación obvia es <em>contar casos</em>. Tratemos de <strong>contar la cantidad de casos de Covid por provincia</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id_evento_caso&#39;, &#39;sexo&#39;, &#39;edad&#39;, &#39;edad_años_meses&#39;,
       &#39;residencia_pais_nombre&#39;, &#39;residencia_provincia_nombre&#39;,
       &#39;residencia_departamento_nombre&#39;, &#39;carga_provincia_nombre&#39;,
       &#39;fecha_inicio_sintomas&#39;, &#39;fecha_apertura&#39;, &#39;sepi_apertura&#39;,
       &#39;fecha_internacion&#39;, &#39;cuidado_intensivo&#39;, &#39;fecha_cui_intensivo&#39;,
       &#39;fallecido&#39;, &#39;fecha_fallecimiento&#39;, &#39;asistencia_respiratoria_mecanica&#39;,
       &#39;carga_provincia_id&#39;, &#39;origen_financiamiento&#39;, &#39;clasificacion&#39;,
       &#39;clasificacion_resumen&#39;, &#39;residencia_provincia_id&#39;, &#39;fecha_diagnostico&#39;,
       &#39;residencia_departamento_id&#39;, &#39;ultima_actualizacion&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># busquemos las columnas que vamos a necesitar usar primero</span>
<span class="n">casos</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_evento_caso</th>
      <th>sexo</th>
      <th>edad</th>
      <th>edad_años_meses</th>
      <th>residencia_pais_nombre</th>
      <th>residencia_provincia_nombre</th>
      <th>residencia_departamento_nombre</th>
      <th>carga_provincia_nombre</th>
      <th>fecha_inicio_sintomas</th>
      <th>fecha_apertura</th>
      <th>...</th>
      <th>fecha_fallecimiento</th>
      <th>asistencia_respiratoria_mecanica</th>
      <th>carga_provincia_id</th>
      <th>origen_financiamiento</th>
      <th>clasificacion</th>
      <th>clasificacion_resumen</th>
      <th>residencia_provincia_id</th>
      <th>fecha_diagnostico</th>
      <th>residencia_departamento_id</th>
      <th>ultima_actualizacion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000000</td>
      <td>M</td>
      <td>53.0</td>
      <td>Años</td>
      <td>Argentina</td>
      <td>CABA</td>
      <td>SIN ESPECIFICAR</td>
      <td>Buenos Aires</td>
      <td>NaN</td>
      <td>2020-06-01</td>
      <td>...</td>
      <td>NaN</td>
      <td>NO</td>
      <td>6</td>
      <td>Privado</td>
      <td>Caso Descartado</td>
      <td>Descartado</td>
      <td>02</td>
      <td>2020-06-09</td>
      <td>0</td>
      <td>2020-09-03</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000002</td>
      <td>M</td>
      <td>21.0</td>
      <td>Años</td>
      <td>Argentina</td>
      <td>Buenos Aires</td>
      <td>La Matanza</td>
      <td>Buenos Aires</td>
      <td>NaN</td>
      <td>2020-06-01</td>
      <td>...</td>
      <td>NaN</td>
      <td>NO</td>
      <td>6</td>
      <td>Público</td>
      <td>Caso Descartado</td>
      <td>Descartado</td>
      <td>06</td>
      <td>2020-06-01</td>
      <td>427</td>
      <td>2020-09-03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000003</td>
      <td>F</td>
      <td>40.0</td>
      <td>Años</td>
      <td>Argentina</td>
      <td>Córdoba</td>
      <td>Capital</td>
      <td>Córdoba</td>
      <td>2020-05-24</td>
      <td>2020-06-01</td>
      <td>...</td>
      <td>NaN</td>
      <td>NO</td>
      <td>14</td>
      <td>Privado</td>
      <td>Caso Descartado</td>
      <td>Descartado</td>
      <td>14</td>
      <td>2020-06-01</td>
      <td>14</td>
      <td>2020-09-03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000005</td>
      <td>F</td>
      <td>58.0</td>
      <td>Años</td>
      <td>Argentina</td>
      <td>Mendoza</td>
      <td>Las Heras</td>
      <td>Mendoza</td>
      <td>NaN</td>
      <td>2020-06-01</td>
      <td>...</td>
      <td>NaN</td>
      <td>NO</td>
      <td>50</td>
      <td>Público</td>
      <td>Caso Descartado</td>
      <td>Descartado</td>
      <td>50</td>
      <td>2020-06-01</td>
      <td>49</td>
      <td>2020-09-03</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000006</td>
      <td>M</td>
      <td>28.0</td>
      <td>Años</td>
      <td>Argentina</td>
      <td>Buenos Aires</td>
      <td>Malvinas Argentinas</td>
      <td>Buenos Aires</td>
      <td>2020-05-30</td>
      <td>2020-06-01</td>
      <td>...</td>
      <td>NaN</td>
      <td>NO</td>
      <td>6</td>
      <td>Público</td>
      <td>Caso sospechoso - Con muestra sin resultado</td>
      <td>Sospechoso</td>
      <td>06</td>
      <td>NaN</td>
      <td>515</td>
      <td>2020-09-03</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos</span><span class="o">.</span><span class="n">residencia_provincia_nombre</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;CABA&#39;, &#39;Buenos Aires&#39;, &#39;Córdoba&#39;, &#39;Mendoza&#39;, &#39;Formosa&#39;,
       &#39;Santa Fe&#39;, &#39;San Luis&#39;, &#39;Entre Ríos&#39;, &#39;Tucumán&#39;, &#39;Chaco&#39;,
       &#39;Corrientes&#39;, &#39;Río Negro&#39;, &#39;La Pampa&#39;, &#39;Santa Cruz&#39;,
       &#39;Santiago del Estero&#39;, &#39;Neuquén&#39;, &#39;SIN ESPECIFICAR&#39;, &#39;San Juan&#39;,
       &#39;Chubut&#39;, &#39;Catamarca&#39;, &#39;Tierra del Fuego&#39;, &#39;Misiones&#39;, &#39;Jujuy&#39;,
       &#39;La Rioja&#39;, &#39;Salta&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">casos</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;fecha&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fecha_inicio_sintomas
fecha_apertura
fecha_internacion
fecha_cui_intensivo
fecha_fallecimiento
fecha_diagnostico
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos</span><span class="o">.</span><span class="n">clasificacion_resumen</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Descartado        741165
Confirmado        451191
Sospechoso        120672
Sin Clasificar        34
Name: clasificacion_resumen, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_provincias</span> <span class="o">=</span> <span class="n">casos</span><span class="p">[</span><span class="n">casos</span><span class="o">.</span><span class="n">clasificacion_resumen</span> <span class="o">==</span> <span class="s2">&quot;Confirmado&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;residencia_provincia_nombre&quot;</span><span class="p">],</span>
    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id_evento_caso&quot;</span><span class="p">],</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;count&quot;</span>
<span class="p">)</span>
<span class="n">casos_provincias</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;id_evento_caso&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_evento_caso</th>
    </tr>
    <tr>
      <th>residencia_provincia_nombre</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Buenos Aires</th>
      <td>277151</td>
    </tr>
    <tr>
      <th>CABA</th>
      <td>99004</td>
    </tr>
    <tr>
      <th>Santa Fe</th>
      <td>10093</td>
    </tr>
    <tr>
      <th>Córdoba</th>
      <td>9837</td>
    </tr>
    <tr>
      <th>Jujuy</th>
      <td>9215</td>
    </tr>
    <tr>
      <th>Mendoza</th>
      <td>8145</td>
    </tr>
    <tr>
      <th>Río Negro</th>
      <td>6506</td>
    </tr>
    <tr>
      <th>Chaco</th>
      <td>5682</td>
    </tr>
    <tr>
      <th>Entre Ríos</th>
      <td>3947</td>
    </tr>
    <tr>
      <th>Salta</th>
      <td>3922</td>
    </tr>
    <tr>
      <th>Neuquén</th>
      <td>3396</td>
    </tr>
    <tr>
      <th>Tucumán</th>
      <td>3071</td>
    </tr>
    <tr>
      <th>Tierra del Fuego</th>
      <td>2232</td>
    </tr>
    <tr>
      <th>Santa Cruz</th>
      <td>1956</td>
    </tr>
    <tr>
      <th>SIN ESPECIFICAR</th>
      <td>1803</td>
    </tr>
    <tr>
      <th>La Rioja</th>
      <td>1788</td>
    </tr>
    <tr>
      <th>Santiago del Estero</th>
      <td>1095</td>
    </tr>
    <tr>
      <th>Chubut</th>
      <td>1061</td>
    </tr>
    <tr>
      <th>Corrientes</th>
      <td>330</td>
    </tr>
    <tr>
      <th>San Juan</th>
      <td>328</td>
    </tr>
    <tr>
      <th>La Pampa</th>
      <td>214</td>
    </tr>
    <tr>
      <th>San Luis</th>
      <td>195</td>
    </tr>
    <tr>
      <th>Formosa</th>
      <td>87</td>
    </tr>
    <tr>
      <th>Catamarca</th>
      <td>69</td>
    </tr>
    <tr>
      <th>Misiones</th>
      <td>64</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Primer reflejo que siempre tenés que tener: controlar el resultado con algún parámetro conocido (en lo posible). En este caso, tratemos de ver si la suma de casos tiene sentido o no.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_provincias</span><span class="o">.</span><span class="n">id_evento_caso</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>451191
</pre></div>
</div>
</div>
</div>
<p>En Google se muestra siempre el último dato reportado a la OMS, es un buen control</p>
<p><a class="reference external" href="https://www.google.com/search?q=casos+coronavirus+argentina&amp;oq=casos+coronavirus&amp;aqs=chrome.1.69i57j0l6j69i60.3332j0j7&amp;sourceid=chrome&amp;ie=UTF-8">https://www.google.com/search?q=casos+coronavirus+argentina&amp;oq=casos+coronavirus&amp;aqs=chrome.1.69i57j0l6j69i60.3332j0j7&amp;sourceid=chrome&amp;ie=UTF-8</a></p>
<p><strong>Ejercicio:</strong> crear una tabla contando la cantidad de casos fallecidos y controlarla. Pista: tenés que agregar un filtro más a la tabla anterior, que use la columna “fecha_fallecimiento”.</p>
</div>
<div class="section" id="crear-un-panel-a-partir-de-un-registro">
<h3><span class="section-number">56.3.2. </span>Crear un panel a partir de un registro<a class="headerlink" href="#crear-un-panel-a-partir-de-un-registro" title="Permalink to this headline">¶</a></h3>
<p>Una estructura muy común de dataset de <strong>panel</strong> tiene:</p>
<ul class="simple">
<li><p>1 o más variables (generalmente numéricas)</p></li>
<li><p>1 dimensión de apertura temporal</p></li>
<li><p>1 o más dimensiones de apertura <em>no temporales</em></p></li>
</ul>
<p>Convertir registros en paneles, es un paso lógico en el procesamiento de datos primarios hacia la construcción de productos estadísticos o analíticos. Encapsula una parte del esfuerzo que conviene hacer bien de una sola vez, y luego utilizar el panel fácilmente para la mayoría de nuestras necesidades.</p>
<p>En este caso vamos a elegir cuáles son nuestras variables de interés para <strong>construir el panel de casos de Covid</strong>:</p>
<ul class="simple">
<li><p>provincia</p></li>
<li><p>sexo</p></li>
<li><p>fecha (tiene que haber una dimensión temporal)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel</span> <span class="o">=</span> <span class="n">casos</span><span class="p">[</span><span class="n">casos</span><span class="o">.</span><span class="n">clasificacion_resumen</span> <span class="o">==</span> <span class="s2">&quot;Confirmado&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;residencia_provincia_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;residencia_provincia_nombre&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sexo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fecha_diagnostico&quot;</span>
    <span class="p">],</span>
    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id_evento_caso&quot;</span><span class="p">],</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;count&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">casos_panel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>residencia_provincia_nombre</th>
      <th>sexo</th>
      <th>fecha_diagnostico</th>
      <th>id_evento_caso</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-06</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-13</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-14</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-16</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4626</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>M</td>
      <td>2020-09-03</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4627</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>NR</td>
      <td>2020-05-30</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4628</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>NR</td>
      <td>2020-06-12</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4629</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>NR</td>
      <td>2020-07-12</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4630</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>NR</td>
      <td>2020-08-17</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>4631 rows × 5 columns</p>
</div></div></div>
</div>
<p>Ahora realizar distintos gráficos es muy fácil! Sólo hay que hacer una tabla dinámica sobre nuestro panel eligiendo las variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_evolucion_genero</span> <span class="o">=</span> <span class="n">casos_panel</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;sexo&quot;</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="s2">&quot;fecha_diagnostico&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="s2">&quot;id_evento_caso&quot;</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span>
<span class="p">)</span>
<span class="n">casos_evolucion_genero</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>sexo</th>
      <th>F</th>
      <th>M</th>
      <th>NR</th>
    </tr>
    <tr>
      <th>fecha_diagnostico</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-03-03</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-03-06</th>
      <td>2.0</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-03-07</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-03-08</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-03-09</th>
      <td>5.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2020-08-30</th>
      <td>2952.0</td>
      <td>3062.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2020-08-31</th>
      <td>4331.0</td>
      <td>4237.0</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>2020-09-01</th>
      <td>4397.0</td>
      <td>4707.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>2020-09-02</th>
      <td>3769.0</td>
      <td>4033.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2020-09-03</th>
      <td>1459.0</td>
      <td>1549.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
<p>183 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_evolucion_genero</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fd1dc3602e0&gt;
</pre></div>
</div>
<img alt="../../_images/clase-2_29_1.png" src="../../_images/clase-2_29_1.png" />
</div>
</div>
<p><strong>Ejercicio:</strong> graficar la evolución de casos por provincia.</p>
</div>
</div>
<div class="section" id="concat">
<h2><span class="section-number">56.4. </span>Concat<a class="headerlink" href="#concat" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html</a></p>
<p>Pero ahora queremos graficar las curvas de casos confirmados y fallecidos, y nos damos cuenta de que a nuestro panel construido para trabajar le falta una nueva dimensión de apertura de la variable <strong>casos</strong>: el <strong>estado</strong> del caso.</p>
<p>Tenemos que agregar la variable <strong>estado</strong> a nuestro panel, con por lo menos dos estados: <strong>confirmados</strong> y <strong>fallecios</strong>. Para esto vamos a construir paneles <strong>idénticos</strong> para cada una de las variables y concatenarlos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel_confirmados</span> <span class="o">=</span> <span class="n">casos</span><span class="p">[</span><span class="n">casos</span><span class="o">.</span><span class="n">clasificacion_resumen</span> <span class="o">==</span> <span class="s2">&quot;Confirmado&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;residencia_provincia_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;residencia_provincia_nombre&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sexo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fecha_diagnostico&quot;</span>
    <span class="p">],</span>
    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id_evento_caso&quot;</span><span class="p">],</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;count&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">casos_panel_confirmados</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>residencia_provincia_nombre</th>
      <th>sexo</th>
      <th>fecha_diagnostico</th>
      <th>id_evento_caso</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-06</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-13</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-14</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-16</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ahora armemos el panel de casos fallecidos con la misma estructura.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel_fallecidos</span> <span class="o">=</span> <span class="n">casos</span><span class="p">[</span><span class="n">casos</span><span class="o">.</span><span class="n">clasificacion_resumen</span> <span class="o">==</span> <span class="s2">&quot;Confirmado&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;residencia_provincia_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;residencia_provincia_nombre&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sexo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fecha_fallecimiento&quot;</span>
    <span class="p">],</span>
    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id_evento_caso&quot;</span><span class="p">],</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;count&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">casos_panel_fallecidos</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>residencia_provincia_nombre</th>
      <th>sexo</th>
      <th>fecha_fallecimiento</th>
      <th>id_evento_caso</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-25</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-28</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-04-06</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-04-07</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-04-09</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Y ahora necesitamos modificar ambos paneles para que tengan la misma estructura, y así poder concatenarlos.</p>
<ul class="simple">
<li><p>Agregar una columna para la dimensión “estado”</p></li>
<li><p>Renombrar las columnas para que sigan teniendo sentido cuando sumemos información</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel_confirmados</span><span class="p">[</span><span class="s2">&quot;estado&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;confirmados&quot;</span>
<span class="n">casos_panel_confirmados</span> <span class="o">=</span> <span class="n">casos_panel_confirmados</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;fecha_diagnostico&quot;</span><span class="p">:</span> <span class="s2">&quot;fecha&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id_evento_caso&quot;</span><span class="p">:</span> <span class="s2">&quot;casos&quot;</span>
<span class="p">})</span>
<span class="n">casos_panel_confirmados</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>residencia_provincia_nombre</th>
      <th>sexo</th>
      <th>fecha</th>
      <th>casos</th>
      <th>estado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-06</td>
      <td>1</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-13</td>
      <td>1</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-14</td>
      <td>3</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-15</td>
      <td>2</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-16</td>
      <td>2</td>
      <td>confirmados</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel_fallecidos</span><span class="p">[</span><span class="s2">&quot;estado&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;fallecidos&quot;</span>
<span class="n">casos_panel_fallecidos</span> <span class="o">=</span> <span class="n">casos_panel_fallecidos</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;fecha_fallecimiento&quot;</span><span class="p">:</span> <span class="s2">&quot;fecha&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id_evento_caso&quot;</span><span class="p">:</span> <span class="s2">&quot;casos&quot;</span>
<span class="p">})</span>
<span class="n">casos_panel_fallecidos</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>residencia_provincia_nombre</th>
      <th>sexo</th>
      <th>fecha</th>
      <th>casos</th>
      <th>estado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-25</td>
      <td>2</td>
      <td>fallecidos</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-28</td>
      <td>1</td>
      <td>fallecidos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-04-06</td>
      <td>1</td>
      <td>fallecidos</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-04-07</td>
      <td>1</td>
      <td>fallecidos</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-04-09</td>
      <td>2</td>
      <td>fallecidos</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Y ahora el momento de la verdad! Generemos un solo panel con todos los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">casos_panel_confirmados</span><span class="p">,</span> <span class="n">casos_panel_fallecidos</span><span class="p">])</span>
<span class="n">casos_panel2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>residencia_provincia_nombre</th>
      <th>sexo</th>
      <th>fecha</th>
      <th>casos</th>
      <th>estado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-06</td>
      <td>1</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-13</td>
      <td>1</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-14</td>
      <td>3</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-15</td>
      <td>2</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-16</td>
      <td>2</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1487</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>M</td>
      <td>2020-07-19</td>
      <td>1</td>
      <td>fallecidos</td>
    </tr>
    <tr>
      <th>1488</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>M</td>
      <td>2020-08-06</td>
      <td>1</td>
      <td>fallecidos</td>
    </tr>
    <tr>
      <th>1489</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>M</td>
      <td>2020-08-18</td>
      <td>1</td>
      <td>fallecidos</td>
    </tr>
    <tr>
      <th>1490</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>M</td>
      <td>2020-08-24</td>
      <td>1</td>
      <td>fallecidos</td>
    </tr>
    <tr>
      <th>1491</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>NR</td>
      <td>2020-06-08</td>
      <td>1</td>
      <td>fallecidos</td>
    </tr>
  </tbody>
</table>
<p>6123 rows × 6 columns</p>
</div></div></div>
</div>
<p>Ya podemos graficar fallecidos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_evolucion_genero2</span> <span class="o">=</span> <span class="n">casos_panel2</span><span class="p">[</span>
    <span class="n">casos_panel2</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;fallecidos&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;sexo&quot;</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="s2">&quot;fecha&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="s2">&quot;casos&quot;</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span>
<span class="p">)</span>
<span class="n">casos_evolucion_genero2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>sexo</th>
      <th>F</th>
      <th>M</th>
      <th>NR</th>
    </tr>
    <tr>
      <th>fecha</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-03-07</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-03-13</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-03-18</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-03-21</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-03-24</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2020-08-30</th>
      <td>44.0</td>
      <td>60.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2020-08-31</th>
      <td>48.0</td>
      <td>60.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2020-09-01</th>
      <td>48.0</td>
      <td>57.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2020-09-02</th>
      <td>29.0</td>
      <td>31.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-09-03</th>
      <td>7.0</td>
      <td>15.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>168 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_evolucion_genero2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fd1d7aaf460&gt;
</pre></div>
</div>
<img alt="../../_images/clase-2_45_1.png" src="../../_images/clase-2_45_1.png" />
</div>
</div>
<p><strong>Ejercicio:</strong> crear el panel <code class="docutils literal notranslate"><span class="pre">casos_panel_descartados</span></code> y concatenarlo a los otros dos generando un <code class="docutils literal notranslate"><span class="pre">casos_panel3</span></code>.</p>
</div>
<div class="section" id="str">
<h2><span class="section-number">56.5. </span>.str<a class="headerlink" href="#str" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.html</a></p>
<p>Todas las columnas (Series) de un data frame tienen diferentes métodos asociados que se pueden utilzar para hacer transformaciones rápidamente.</p>
<p>Hay un grupo de ellos accesible a través del atributo <code class="docutils literal notranslate"><span class="pre">str</span></code> (<code class="docutils literal notranslate"><span class="pre">Series.str</span></code>) que implementa las funciones usuales de Python sobre strings, para una columna de valores de texto.</p>
<div class="section" id="str-replace">
<h3><span class="section-number">56.5.1. </span>.str.replace()<a class="headerlink" href="#str-replace" title="Permalink to this headline">¶</a></h3>
<p>Si queremos graficar la evolución de casos por sexo, pero queremos una leyenda con la palabra completa, tal vez necesitemos reemplazar los valores usados en el dataset por otros.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>residencia_provincia_nombre</th>
      <th>sexo</th>
      <th>fecha</th>
      <th>casos</th>
      <th>estado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-06</td>
      <td>1</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-13</td>
      <td>1</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-14</td>
      <td>3</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-15</td>
      <td>2</td>
      <td>confirmados</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>CABA</td>
      <td>F</td>
      <td>2020-03-16</td>
      <td>2</td>
      <td>confirmados</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel2</span><span class="p">[</span><span class="s2">&quot;sexo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">casos_panel2</span><span class="o">.</span><span class="n">sexo</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;Femenino&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;Masculino&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="s2">&quot;NR&quot;</span><span class="p">,</span> <span class="s2">&quot;No responde&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel2</span><span class="o">.</span><span class="n">sexo</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Masculino      3048
Femenino       2722
No responde     353
Name: sexo, dtype: int64
</pre></div>
</div>
</div>
</div>
<p><strong>Ejercicio:</strong> modificar la columna <code class="docutils literal notranslate"><span class="pre">residencia_provincia_nombre</span></code> reemplazando “CABA” por “Ciudad Autónoma de Buenos Aires”.</p>
</div>
<div class="section" id="str-split">
<h3><span class="section-number">56.5.2. </span>.str.split()<a class="headerlink" href="#str-split" title="Permalink to this headline">¶</a></h3>
<p>Si queremos agrupar por mes, tal vez necesitamos partir la fecha en tres partes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel2</span><span class="o">.</span><span class="n">fecha</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       [2020, 03, 06]
1       [2020, 03, 13]
2       [2020, 03, 14]
3       [2020, 03, 15]
4       [2020, 03, 16]
             ...      
1487    [2020, 07, 19]
1488    [2020, 08, 06]
1489    [2020, 08, 18]
1490    [2020, 08, 24]
1491    [2020, 06, 08]
Name: fecha, Length: 6123, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Para poder asignar esas 3 partes a 3 columnas diferentes a la vez, debe agregarse otro <code class="docutils literal notranslate"><span class="pre">.str</span></code> al final.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel2</span><span class="p">[</span><span class="s2">&quot;anio&quot;</span><span class="p">],</span> <span class="n">casos_panel2</span><span class="p">[</span><span class="s2">&quot;mes&quot;</span><span class="p">],</span> <span class="n">casos_panel2</span><span class="p">[</span><span class="s2">&quot;dia&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">casos_panel2</span><span class="o">.</span><span class="n">fecha</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-25-dba13a532ee8&gt;:1: FutureWarning: Columnar iteration over characters will be deprecated in future releases.
  casos_panel2[&quot;anio&quot;], casos_panel2[&quot;mes&quot;], casos_panel2[&quot;dia&quot;] = casos_panel2.fecha.str.split(&quot;-&quot;).str
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>residencia_provincia_nombre</th>
      <th>sexo</th>
      <th>fecha</th>
      <th>casos</th>
      <th>estado</th>
      <th>anio</th>
      <th>mes</th>
      <th>dia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>CABA</td>
      <td>Femenino</td>
      <td>2020-03-06</td>
      <td>1</td>
      <td>confirmados</td>
      <td>2020</td>
      <td>03</td>
      <td>06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>CABA</td>
      <td>Femenino</td>
      <td>2020-03-13</td>
      <td>1</td>
      <td>confirmados</td>
      <td>2020</td>
      <td>03</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>CABA</td>
      <td>Femenino</td>
      <td>2020-03-14</td>
      <td>3</td>
      <td>confirmados</td>
      <td>2020</td>
      <td>03</td>
      <td>14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>CABA</td>
      <td>Femenino</td>
      <td>2020-03-15</td>
      <td>2</td>
      <td>confirmados</td>
      <td>2020</td>
      <td>03</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>CABA</td>
      <td>Femenino</td>
      <td>2020-03-16</td>
      <td>2</td>
      <td>confirmados</td>
      <td>2020</td>
      <td>03</td>
      <td>16</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1487</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>Masculino</td>
      <td>2020-07-19</td>
      <td>1</td>
      <td>fallecidos</td>
      <td>2020</td>
      <td>07</td>
      <td>19</td>
    </tr>
    <tr>
      <th>1488</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>Masculino</td>
      <td>2020-08-06</td>
      <td>1</td>
      <td>fallecidos</td>
      <td>2020</td>
      <td>08</td>
      <td>06</td>
    </tr>
    <tr>
      <th>1489</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>Masculino</td>
      <td>2020-08-18</td>
      <td>1</td>
      <td>fallecidos</td>
      <td>2020</td>
      <td>08</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1490</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>Masculino</td>
      <td>2020-08-24</td>
      <td>1</td>
      <td>fallecidos</td>
      <td>2020</td>
      <td>08</td>
      <td>24</td>
    </tr>
    <tr>
      <th>1491</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>No responde</td>
      <td>2020-06-08</td>
      <td>1</td>
      <td>fallecidos</td>
      <td>2020</td>
      <td>06</td>
      <td>08</td>
    </tr>
  </tbody>
</table>
<p>6123 rows × 9 columns</p>
</div></div></div>
</div>
<p><strong>Ejercicio:</strong> separar la fecha en “anio”, “mes” y “dia” en el <code class="docutils literal notranslate"><span class="pre">casos_panel3</span></code> que crearon antes.</p>
</div>
</div>
<div class="section" id="map">
<h2><span class="section-number">56.6. </span>.map<a class="headerlink" href="#map" title="Permalink to this headline">¶</a></h2>
<p>Tal vez notaron lo impráctico que puede resultar el método <code class="docutils literal notranslate"><span class="pre">.str.replace()</span></code> cuando la lista de reemplazos sea larga. Para este caso existe el método <code class="docutils literal notranslate"><span class="pre">.map()</span></code>, al que se le puede pasar un diccionario con los reemplazos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel2</span><span class="p">[</span><span class="s2">&quot;sexo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">casos_panel2</span><span class="o">.</span><span class="n">sexo</span><span class="o">.</span><span class="n">map</span><span class="p">({</span>
    <span class="s2">&quot;Masculino&quot;</span><span class="p">:</span> <span class="s2">&quot;Masc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Femenino&quot;</span><span class="p">:</span> <span class="s2">&quot;Fem&quot;</span><span class="p">,</span>
    <span class="s2">&quot;No responde&quot;</span><span class="p">:</span> <span class="s2">&quot;Sin especificar&quot;</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel2</span><span class="o">.</span><span class="n">sexo</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Masc               3048
Fem                2722
Sin especificar     353
Name: sexo, dtype: int64
</pre></div>
</div>
</div>
</div>
<p><strong>Ejercicio:</strong> modificar las categorías de la columna “estado” por “positivos” (en lugar de “confirmados”), “decesos” (en lugar de “fallecidos”) y “negativos” (en lugar de “descartados”).</p>
</div>
<div class="section" id="merge">
<h2><span class="section-number">56.7. </span>Merge<a class="headerlink" href="#merge" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html</a></p>
<p>“Mergear”, “joinear” o cruzar dos datasets, implica elegir una o más columnas que estos tengan en común y utilizarlas para cruzar ambas tablas en base a la coincidencia de valores entre ambas. Existen varios tipos de <em>joins</em> según cuál es el resultado que nos interesa obtener al final con la cruza:</p>
<ul class="simple">
<li><p><strong>left join</strong>: preserva el 100% de las filas que tiene la tabla <em>de la izquierda</em> del merge, y agrega las columnas del dataset <em>de la derecha</em> con los valores (cuando hay una coincidencia) o las llena con valores nulos (cuando no hay coincidencia). Si el dataset de la derecha tiene valores para filas que no están presentes en el dataset de la izquierda, simplemente no se utilizan. El dataset resultado tiene la misma cantidad de filas que el dataset de la izquierda.</p></li>
<li><p><strong>right join</strong>: es igual que el anterior, pero se preservan las filas del dataset de la derecha en lugar de las del de la izquierda.</p></li>
<li><p><strong>inner join</strong>: sólo se mantienen aquellas filas que coinciden <em>en ambos datasets</em>. Si alguna fila no tiene coincidencia en uno de los dos, se descarta. El dataset final tiene igual cantidad o menos filas que el dataset más grande.</p></li>
<li><p><strong>outer join</strong>: se preservan todas las filas. Si hay coincidencia, se cruzan, y si no hay coincidencia se apilan llenando con valores nulos.</p></li>
</ul>
<p>El tipo de join más común que van a utilizar la mayoría de las veces es el <strong>left join</strong>, cuyo caso de uso es “tengo una tabla, y quiero enriquecerla con nuevas columnas”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">url</span><span class="o">=</span> <span class="s2">&quot;https://datasets-humai.s3.amazonaws.com/datasets/joins.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><img src="https://datasets-humai.s3.amazonaws.com/datasets/joins.png"/></div></div>
</div>
<p>Ahora, queremos calcular y graficar un indicador utilizado en algunos análisis que es la cantidad de testeos sobre la cantidad de casos confirmados.</p>
<p>Este indicador nos dice cuántos tests están siendo necesarios para identificar cada caso positivo de Covid. Para esto vamos a necesitar cruzar los datos de <strong>determinaciones</strong> con los de <strong>casos</strong>.</p>
<p>Hasta ahora nuestro panel tenía una sola variable! Pero ya es hora de que le agreguemos otra: <code class="docutils literal notranslate"><span class="pre">tests</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_panel2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>residencia_provincia_nombre</th>
      <th>sexo</th>
      <th>fecha</th>
      <th>casos</th>
      <th>estado</th>
      <th>anio</th>
      <th>mes</th>
      <th>dia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>CABA</td>
      <td>Fem</td>
      <td>2020-03-06</td>
      <td>1</td>
      <td>confirmados</td>
      <td>2020</td>
      <td>03</td>
      <td>06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>CABA</td>
      <td>Fem</td>
      <td>2020-03-13</td>
      <td>1</td>
      <td>confirmados</td>
      <td>2020</td>
      <td>03</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>CABA</td>
      <td>Fem</td>
      <td>2020-03-14</td>
      <td>3</td>
      <td>confirmados</td>
      <td>2020</td>
      <td>03</td>
      <td>14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>CABA</td>
      <td>Fem</td>
      <td>2020-03-15</td>
      <td>2</td>
      <td>confirmados</td>
      <td>2020</td>
      <td>03</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>CABA</td>
      <td>Fem</td>
      <td>2020-03-16</td>
      <td>2</td>
      <td>confirmados</td>
      <td>2020</td>
      <td>03</td>
      <td>16</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1487</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>Masc</td>
      <td>2020-07-19</td>
      <td>1</td>
      <td>fallecidos</td>
      <td>2020</td>
      <td>07</td>
      <td>19</td>
    </tr>
    <tr>
      <th>1488</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>Masc</td>
      <td>2020-08-06</td>
      <td>1</td>
      <td>fallecidos</td>
      <td>2020</td>
      <td>08</td>
      <td>06</td>
    </tr>
    <tr>
      <th>1489</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>Masc</td>
      <td>2020-08-18</td>
      <td>1</td>
      <td>fallecidos</td>
      <td>2020</td>
      <td>08</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1490</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>Masc</td>
      <td>2020-08-24</td>
      <td>1</td>
      <td>fallecidos</td>
      <td>2020</td>
      <td>08</td>
      <td>24</td>
    </tr>
    <tr>
      <th>1491</th>
      <td>99</td>
      <td>SIN ESPECIFICAR</td>
      <td>Sin especificar</td>
      <td>2020-06-08</td>
      <td>1</td>
      <td>fallecidos</td>
      <td>2020</td>
      <td>06</td>
      <td>08</td>
    </tr>
  </tbody>
</table>
<p>6123 rows × 9 columns</p>
</div></div></div>
</div>
<p>¿Cómo hacemos esto? Para cruzar (o “joinear”) un dataset con otro, necesitamos definir un conjunto de columnas común por el cual hacerlo, esto a veces se llama <strong>clave primaria</strong> (o “primary key”).</p>
<p>La clave primaria de una tabla es el conjunto de columnas necesarias para identificar a una sola fila de la tabla. Si miramos nuestro último panel, vemos que necesitamos las columnas <strong>provincia</strong>, <strong>sexo</strong>, <strong>fecha</strong> y <strong>estado</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">determinaciones</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fecha</th>
      <th>provincia</th>
      <th>codigo_indec_provincia</th>
      <th>departamento</th>
      <th>codigo_indec_departamento</th>
      <th>localidad</th>
      <th>codigo_indec_localidad</th>
      <th>origen_financiamiento</th>
      <th>tipo</th>
      <th>ultima_actualizacion</th>
      <th>total</th>
      <th>positivos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-08-13</td>
      <td>Jujuy</td>
      <td>38</td>
      <td>Dr. Manuel Belgrano</td>
      <td>021</td>
      <td>SAN SALVADOR DE JUJUY</td>
      <td>NaN</td>
      <td>Público</td>
      <td>Provincial</td>
      <td>2020-09-03</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-07-13</td>
      <td>CABA</td>
      <td>02</td>
      <td>COMUNA 02</td>
      <td>002</td>
      <td>RECOLETA</td>
      <td>NaN</td>
      <td>Público</td>
      <td>Universitario público</td>
      <td>2020-09-03</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-02-11</td>
      <td>CABA</td>
      <td>02</td>
      <td>COMUNA 04</td>
      <td>004</td>
      <td>PARQUE PATRICIOS</td>
      <td>NaN</td>
      <td>Público</td>
      <td>Nacional</td>
      <td>2020-09-03</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-02-20</td>
      <td>CABA</td>
      <td>02</td>
      <td>COMUNA 04</td>
      <td>004</td>
      <td>PARQUE PATRICIOS</td>
      <td>NaN</td>
      <td>Público</td>
      <td>Nacional</td>
      <td>2020-09-03</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-02-20</td>
      <td>Buenos Aires</td>
      <td>06</td>
      <td>Bahía Blanca</td>
      <td>056</td>
      <td>BAHIA BLANCA</td>
      <td>NaN</td>
      <td>Privado</td>
      <td>Privado</td>
      <td>2020-09-03</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19044</th>
      <td>2020-09-03</td>
      <td>Buenos Aires</td>
      <td>06</td>
      <td>Esteban Echeverría</td>
      <td>260</td>
      <td>MONTE GRANDE</td>
      <td>NaN</td>
      <td>Privado</td>
      <td>Privado</td>
      <td>2020-09-03</td>
      <td>2</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>19045</th>
      <td>2020-09-03</td>
      <td>Buenos Aires</td>
      <td>06</td>
      <td>Avellaneda</td>
      <td>035</td>
      <td>AVELLANEDA</td>
      <td>NaN</td>
      <td>Privado</td>
      <td>Privado</td>
      <td>2020-09-03</td>
      <td>4</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>19046</th>
      <td>2020-09-03</td>
      <td>CABA</td>
      <td>02</td>
      <td>COMUNA 01</td>
      <td>001</td>
      <td>RETIRO</td>
      <td>NaN</td>
      <td>Privado</td>
      <td>Privado</td>
      <td>2020-09-03</td>
      <td>3</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>19047</th>
      <td>2020-09-03</td>
      <td>Buenos Aires</td>
      <td>06</td>
      <td>San Isidro</td>
      <td>756</td>
      <td>MARTINEZ</td>
      <td>NaN</td>
      <td>Público</td>
      <td>Nacional</td>
      <td>2020-09-03</td>
      <td>5</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>19048</th>
      <td>2020-09-03</td>
      <td>Santa Cruz</td>
      <td>78</td>
      <td>Güer Aike</td>
      <td>021</td>
      <td>RIO GALLEGOS</td>
      <td>NaN</td>
      <td>Público</td>
      <td>Provincial</td>
      <td>2020-09-03</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>19049 rows × 12 columns</p>
</div></div></div>
</div>
<p>Sin embargo el panel de “determinaciones” sólo comparte las columnas <strong>fecha</strong> y <strong>provincia</strong>, así que necesitamos generar dos paneles con esa clave primaria para poder cruzarlos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_confirmados_provincias</span> <span class="o">=</span> <span class="n">casos_panel2</span><span class="p">[</span>
    <span class="n">casos_panel2</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;confirmados&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;residencia_provincia_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fecha&quot;</span><span class="p">],</span>
    <span class="n">values</span><span class="o">=</span><span class="s2">&quot;casos&quot;</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">casos_confirmados_provincias</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>fecha</th>
      <th>casos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>2020-03-03</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>2020-03-06</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>2020-03-07</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>2020-03-08</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>2020-03-09</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2451</th>
      <td>99</td>
      <td>2020-08-30</td>
      <td>14</td>
    </tr>
    <tr>
      <th>2452</th>
      <td>99</td>
      <td>2020-08-31</td>
      <td>29</td>
    </tr>
    <tr>
      <th>2453</th>
      <td>99</td>
      <td>2020-09-01</td>
      <td>18</td>
    </tr>
    <tr>
      <th>2454</th>
      <td>99</td>
      <td>2020-09-02</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2455</th>
      <td>99</td>
      <td>2020-09-03</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<p>2456 rows × 3 columns</p>
</div></div></div>
</div>
<p>Siempre recuerden controlar el resultado!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_confirmados_provincias</span><span class="o">.</span><span class="n">casos</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>443227
</pre></div>
</div>
</div>
</div>
<p>Ahora hacemos un panel de determinaciones con la misma estructura.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">determinaciones_panel</span> <span class="o">=</span> <span class="n">determinaciones</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;codigo_indec_provincia&quot;</span><span class="p">,</span> <span class="s2">&quot;fecha&quot;</span><span class="p">],</span>
    <span class="n">values</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">determinaciones_panel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>codigo_indec_provincia</th>
      <th>fecha</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>2019-07-13</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>2020-02-11</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>2020-02-20</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>2020-02-27</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>2020-02-28</td>
      <td>10</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3672</th>
      <td>99</td>
      <td>2020-08-29</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3673</th>
      <td>99</td>
      <td>2020-08-31</td>
      <td>29</td>
    </tr>
    <tr>
      <th>3674</th>
      <td>99</td>
      <td>2020-09-01</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3675</th>
      <td>99</td>
      <td>2020-09-02</td>
      <td>14</td>
    </tr>
    <tr>
      <th>3676</th>
      <td>99</td>
      <td>2020-09-03</td>
      <td>125</td>
    </tr>
  </tbody>
</table>
<p>3677 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">determinaciones_panel</span><span class="o">.</span><span class="n">total</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1409989
</pre></div>
</div>
</div>
</div>
<p>Llegó el momento del join! Recordemos que el objetivo es terminar con un solo panel, donde haya ahora dos variables: <strong>casos</strong> y <strong>tests</strong> ; con apertura por las dos dimensiones que comparten los datasets: <strong>provincia</strong> y <strong>fecha</strong>.</p>
<p>Para esto vamos a usar la función <code class="docutils literal notranslate"><span class="pre">DataFrame.merge()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_tests</span> <span class="o">=</span> <span class="n">casos_confirmados_provincias</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">determinaciones_panel</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;residencia_provincia_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fecha&quot;</span><span class="p">],</span>
    <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;codigo_indec_provincia&quot;</span><span class="p">,</span> <span class="s2">&quot;fecha&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">casos_tests</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>fecha</th>
      <th>casos</th>
      <th>codigo_indec_provincia</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>2020-03-03</td>
      <td>1</td>
      <td>02</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>2020-03-06</td>
      <td>4</td>
      <td>02</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>2020-03-07</td>
      <td>1</td>
      <td>02</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>2020-03-08</td>
      <td>2</td>
      <td>02</td>
      <td>28</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>2020-03-09</td>
      <td>1</td>
      <td>02</td>
      <td>13</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2273</th>
      <td>99</td>
      <td>2020-08-29</td>
      <td>24</td>
      <td>99</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2274</th>
      <td>99</td>
      <td>2020-08-31</td>
      <td>29</td>
      <td>99</td>
      <td>29</td>
    </tr>
    <tr>
      <th>2275</th>
      <td>99</td>
      <td>2020-09-01</td>
      <td>18</td>
      <td>99</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2276</th>
      <td>99</td>
      <td>2020-09-02</td>
      <td>16</td>
      <td>99</td>
      <td>14</td>
    </tr>
    <tr>
      <th>2277</th>
      <td>99</td>
      <td>2020-09-03</td>
      <td>8</td>
      <td>99</td>
      <td>125</td>
    </tr>
  </tbody>
</table>
<p>2278 rows × 5 columns</p>
</div></div></div>
</div>
<p>Bien! Noten que si la columna coincide en nombre, quedará una sola columna, pero si los nombres son diferentes tendremos una columna duplicada (que no queremos). Además deberíamos clarificar el nombre de la segunda variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_tests</span> <span class="o">=</span> <span class="n">casos_tests</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;codigo_indec_provincia&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">casos_tests</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>fecha</th>
      <th>casos</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>2020-03-03</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>2020-03-06</td>
      <td>4</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>2020-03-07</td>
      <td>1</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>2020-03-08</td>
      <td>2</td>
      <td>28</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>2020-03-09</td>
      <td>1</td>
      <td>13</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2273</th>
      <td>99</td>
      <td>2020-08-29</td>
      <td>24</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2274</th>
      <td>99</td>
      <td>2020-08-31</td>
      <td>29</td>
      <td>29</td>
    </tr>
    <tr>
      <th>2275</th>
      <td>99</td>
      <td>2020-09-01</td>
      <td>18</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2276</th>
      <td>99</td>
      <td>2020-09-02</td>
      <td>16</td>
      <td>14</td>
    </tr>
    <tr>
      <th>2277</th>
      <td>99</td>
      <td>2020-09-03</td>
      <td>8</td>
      <td>125</td>
    </tr>
  </tbody>
</table>
<p>2278 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_tests</span> <span class="o">=</span> <span class="n">casos_tests</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="s2">&quot;tests&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">casos_tests</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>fecha</th>
      <th>casos</th>
      <th>tests</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>2020-03-03</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>2020-03-06</td>
      <td>4</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>2020-03-07</td>
      <td>1</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>2020-03-08</td>
      <td>2</td>
      <td>28</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>2020-03-09</td>
      <td>1</td>
      <td>13</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2273</th>
      <td>99</td>
      <td>2020-08-29</td>
      <td>24</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2274</th>
      <td>99</td>
      <td>2020-08-31</td>
      <td>29</td>
      <td>29</td>
    </tr>
    <tr>
      <th>2275</th>
      <td>99</td>
      <td>2020-09-01</td>
      <td>18</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2276</th>
      <td>99</td>
      <td>2020-09-02</td>
      <td>16</td>
      <td>14</td>
    </tr>
    <tr>
      <th>2277</th>
      <td>99</td>
      <td>2020-09-03</td>
      <td>8</td>
      <td>125</td>
    </tr>
  </tbody>
</table>
<p>2278 rows × 4 columns</p>
</div></div></div>
</div>
<p>¿Por qué no usamos concat en lugar de merge, y agregamos una columna que se llame <code class="docutils literal notranslate"><span class="pre">variable</span></code> y tenga los valores “casos” y “tests”?</p>
<p>Esto también hubiera sido una estructura de panel posible, con sus ventajas y desventajas. Si tuviéramos una <em>gran cantidad</em> de variables tal vez es mejor elegir esa estructura de dataset <strong>más vertical</strong>, pero si tenemos pocas, tal vez es mejor que cada variable sea una columna.</p>
<p>¿No son casos confirmados y casos fallecidos variables distintas también? Sí, podría pensarse así. Pero en este caso sí es más claro que se puede modelar como una variable <strong>casos</strong> con una dimensión de apertura que es el <strong>estado</strong> del caso.</p>
<p>Ahora queremos calcular una nueva variable: tests x caso confirmado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_tests</span><span class="p">[</span><span class="s2">&quot;tests_por_confirmado&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">casos_tests</span><span class="o">.</span><span class="n">tests</span> <span class="o">/</span> <span class="n">casos_tests</span><span class="o">.</span><span class="n">casos</span>

<span class="n">casos_tests</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>residencia_provincia_id</th>
      <th>fecha</th>
      <th>casos</th>
      <th>tests</th>
      <th>tests_por_confirmado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02</td>
      <td>2020-03-03</td>
      <td>1</td>
      <td>8</td>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>2020-03-06</td>
      <td>4</td>
      <td>11</td>
      <td>2.750000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02</td>
      <td>2020-03-07</td>
      <td>1</td>
      <td>9</td>
      <td>9.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02</td>
      <td>2020-03-08</td>
      <td>2</td>
      <td>28</td>
      <td>14.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02</td>
      <td>2020-03-09</td>
      <td>1</td>
      <td>13</td>
      <td>13.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2273</th>
      <td>99</td>
      <td>2020-08-29</td>
      <td>24</td>
      <td>1</td>
      <td>0.041667</td>
    </tr>
    <tr>
      <th>2274</th>
      <td>99</td>
      <td>2020-08-31</td>
      <td>29</td>
      <td>29</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2275</th>
      <td>99</td>
      <td>2020-09-01</td>
      <td>18</td>
      <td>40</td>
      <td>2.222222</td>
    </tr>
    <tr>
      <th>2276</th>
      <td>99</td>
      <td>2020-09-02</td>
      <td>16</td>
      <td>14</td>
      <td>0.875000</td>
    </tr>
    <tr>
      <th>2277</th>
      <td>99</td>
      <td>2020-09-03</td>
      <td>8</td>
      <td>125</td>
      <td>15.625000</td>
    </tr>
  </tbody>
</table>
<p>2278 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casos_tests</span><span class="p">[</span>
    <span class="n">casos_tests</span><span class="o">.</span><span class="n">residencia_provincia_id</span> <span class="o">==</span> <span class="s2">&quot;02&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
    <span class="s2">&quot;fecha&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">tests_por_confirmado</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fd1d7ae38b0&gt;
</pre></div>
</div>
<img alt="../../_images/clase-2_94_1.png" src="../../_images/clase-2_94_1.png" />
</div>
</div>
<p>Esta variable puede tener variadas interpretaciones. ¿Qué significa si baja? ¿Se están haciendo los testeos focalizados en zonas con brotes? ¿Se necesitan hacer más tests para estar seguro de que se detecta la cantidad de casos necesarios para localizar los brotes?</p>
<p>Hay muchas interpretaciones posibles, y probablemente requieran de una interpretación más sofisticada. Se lo dejamos a los expertos!</p>
<p><strong>Ejercicio:</strong> repetir el gráfico para otras provincias y analizar si se comportan de forma similar.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./AnalisisDeDatos/2_Pivot_Table_y_Joins"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../1_Indexing/ejercicio/ejercicio.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">55. </span>Ejercicios Pandas I</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="clase-2-ejercicios.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">57. </span>Ejercicios Pandas II</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Matías Grinberg<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>